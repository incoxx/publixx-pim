import{o as ee,t as o,v as e,D as r,x as s,j as v,F as C,z as j,A as S,B as y,E as g,y as d,L as te,M as se,r as u,q as a}from"./vendor-B0bC02TM.js";import{e as h,c as E,b as ae,h as re,u as oe,i as le,j as U,G as ne}from"./index-aO8txVii.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=h("CircleCheckBigIcon",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A=h("CircleXIcon",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=h("LoaderCircleIcon",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=h("PaletteIcon",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=h("RotateCcwIcon",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=h("ServerIcon",[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ie=h("TriangleAlertIcon",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),M={resetData(B){return E.post("/admin/reset-data",{confirmation:B})},loadDemoData(){return E.post("/admin/load-demo-data",{},{timeout:3e5})},getDeployStatus(){return E.get("/admin/deploy/status")},deploy(){return E.post("/admin/deploy",{},{timeout:3e5})},rollback(B){return E.post("/admin/deploy/rollback",{commit_hash:B})}},ue={class:"space-y-6 max-w-2xl"},xe={class:"text-lg font-semibold text-[var(--color-text-primary)]"},ve={class:"pim-card p-6 space-y-4"},me={class:"flex items-center gap-3 mb-2"},pe={class:"text-sm font-semibold"},ye={class:"block text-[12px] font-medium text-[var(--color-text-secondary)] mb-1"},ge=["value"],be=["value"],he={class:"block text-[12px] font-medium text-[var(--color-text-secondary)] mb-1"},ke={class:"flex gap-2"},fe=["checked","onChange"],_e={class:"pim-card p-6 space-y-4"},we={class:"flex items-center gap-3 mb-2"},De={class:"text-sm font-semibold"},Ce={class:"text-xs text-[var(--color-text-tertiary)]"},Se={key:0,class:"pim-card border border-blue-300 dark:border-blue-800 p-6 space-y-4"},Le={class:"flex items-center gap-3 mb-2"},Re={key:0,class:"text-xs mt-1 text-[var(--color-text-secondary)]"},ze={key:1,class:"mt-2 text-xs"},Ee={class:"mt-2 bg-[var(--color-bg-secondary)] rounded p-3 overflow-x-auto text-[11px]"},Ae={key:1,class:"bg-red-50 dark:bg-red-950/30 border border-red-200 dark:border-red-800 rounded-lg p-4"},Me={class:"flex items-center gap-2 text-red-700 dark:text-red-400 text-sm font-medium"},Be={class:"text-xs text-red-600 dark:text-red-400 mt-1"},Ie={key:2,class:"flex items-center gap-3 text-sm text-[var(--color-text-secondary)]"},Pe={key:3,class:"flex items-center gap-3"},Te={key:1,class:"pim-card border border-red-300 dark:border-red-800 p-6 space-y-4"},qe={class:"flex items-center gap-3 mb-2"},Ve={class:"text-sm font-semibold text-red-600 dark:text-red-400"},Fe={class:"text-sm font-medium text-[var(--color-text-primary)] mb-1"},Ge={class:"text-xs text-[var(--color-text-tertiary)] mb-3"},Ne={key:1,class:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4 space-y-3"},$e={class:"text-xs text-red-700 dark:text-red-300 font-medium"},je=["disabled"],He={class:"flex gap-2"},Je=["disabled"],Ue={key:0},Xe={key:1},Oe=["disabled"],We={key:2,class:"pim-card p-6 space-y-5"},Ze={class:"flex items-center gap-3 mb-2"},Ke={key:0,class:"bg-[var(--color-bg-secondary)] rounded-lg p-4 space-y-2"},Qe={class:"flex items-center gap-2 text-xs text-[var(--color-text-secondary)]"},Ye={class:"font-mono font-medium"},et={class:"font-mono text-[var(--color-accent)]"},tt={class:"text-xs text-[var(--color-text-secondary)]"},st={class:"text-[11px] text-[var(--color-text-tertiary)]"},at={class:"flex items-center gap-3"},rt=["disabled"],ot={key:1,class:"flex items-center gap-3 text-sm text-[var(--color-text-secondary)]"},lt={key:2,class:"bg-red-50 dark:bg-red-950/30 border border-red-200 dark:border-red-800 rounded-lg p-4"},nt={class:"flex items-center gap-2 text-red-700 dark:text-red-400 text-sm font-medium"},dt={class:"text-xs text-red-600 dark:text-red-400 mt-1"},ct={key:3,class:"space-y-3"},it={class:"text-xs"},ut={class:"cursor-pointer text-[var(--color-text-secondary)] hover:text-[var(--color-text-primary)]"},xt={class:"mt-2 space-y-1 font-mono bg-[var(--color-bg-secondary)] rounded-lg p-3 max-h-64 overflow-y-auto"},vt={class:"font-medium"},mt={key:0,class:"text-[var(--color-text-tertiary)] ml-2"},pt={key:0,class:"flex items-center gap-3 pt-2 border-t border-[var(--color-border)]"},yt={class:"text-xs text-[var(--color-text-secondary)]"},gt={class:"font-mono"},bt=["disabled"],_t={__name:"SettingsView",setup(B){const{t:i}=ae(),k=re(),F=oe(),G=F.hasPermission("*")||F.userRole==="Admin",b=u(""),f=u(!1),I=u(!1),_=u(""),L=u(!1);function O(){b.value="",_.value="",L.value=!1,I.value=!0}function W(){I.value=!1,b.value=""}async function Z(){var x,t;if(b.value==="RESET"){f.value=!0,_.value="",L.value=!1;try{await M.resetData("RESET"),_.value=i("settings.resetSuccess"),L.value=!1,I.value=!1,b.value=""}catch(n){_.value=((t=(x=n.response)==null?void 0:x.data)==null?void 0:t.detail)||i("settings.resetError"),L.value=!0}finally{f.value=!1}}}const P=u(!1),m=u(null),T=u(null),R=u(!1);async function K(){var x,t;R.value=!1,P.value=!0,m.value=null,T.value=null;try{const{data:n}=await M.loadDemoData();m.value=n}catch(n){T.value=((t=(x=n.response)==null?void 0:x.data)==null?void 0:t.detail)||n.message||"Demo-Daten laden fehlgeschlagen"}finally{P.value=!1}}const p=u(null),w=u(!1),c=u(null),D=u(null),N=u(""),q=u(!1),z=u(!1);async function $(){if(G)try{const{data:x}=await M.getDeployStatus();p.value=x}catch{p.value=null}}async function Q(){var x,t;z.value=!1,w.value=!0,c.value=null,D.value=null;try{const{data:n}=await M.deploy();c.value=n,N.value=n.backup_hash||"",await $()}catch(n){D.value=((t=(x=n.response)==null?void 0:x.data)==null?void 0:t.detail)||n.message||"Deployment fehlgeschlagen"}finally{w.value=!1}}async function Y(){var x,t;if(N.value){q.value=!0,c.value=null,D.value=null;try{const{data:n}=await M.rollback(N.value);c.value=n,await $()}catch(n){D.value=((t=(x=n.response)==null?void 0:x.data)==null?void 0:t.detail)||n.message||"Rollback fehlgeschlagen"}finally{q.value=!1}}}return ee($),(x,t)=>{var n,J;return a(),o("div",ue,[e("h2",xe,r(s(i)("settings.title")),1),e("div",ve,[e("div",me,[v(s(le),{class:"w-5 h-5 text-[var(--color-accent)]","stroke-width":1.75}),e("h3",pe,r(s(i)("settings.language")),1)]),e("div",null,[e("label",ye,r(s(i)("settings.uiLanguage")),1),e("select",{class:"pim-input max-w-xs",value:s(k).currentLocale,onChange:t[0]||(t[0]=l=>s(k).setUiLocale(l.target.value))},[(a(!0),o(C,null,j(s(k).availableLocales,l=>(a(),o("option",{key:l.code,value:l.code},r(l.label),9,be))),128))],40,ge)]),e("div",null,[e("label",he,r(s(i)("settings.dataLanguages")),1),e("div",ke,[(a(!0),o(C,null,j(s(k).availableLocales,l=>(a(),o("label",{key:l.code,class:"flex items-center gap-1.5 text-xs cursor-pointer"},[e("input",{type:"checkbox",checked:s(k).activeDataLocales.includes(l.code),onChange:ht=>s(k).toggleDataLocale(l.code),class:"rounded border-[var(--color-border-strong)] text-[var(--color-accent)]"},null,40,fe),g(" "+r(l.label),1)]))),128))])])]),e("div",_e,[e("div",we,[v(s(de),{class:"w-5 h-5 text-[var(--color-accent)]","stroke-width":1.75}),e("h3",De,r(s(i)("settings.appearance")),1)]),e("p",Ce,r(s(i)("settings.appearancePlaceholder")),1)]),s(G)?(a(),o("div",Se,[e("div",Le,[v(s(U),{class:"w-5 h-5 text-blue-500","stroke-width":1.75}),t[6]||(t[6]=e("h3",{class:"text-sm font-semibold text-blue-600 dark:text-blue-400"},"Demo-Daten laden",-1))]),t[12]||(t[12]=e("p",{class:"text-xs text-[var(--color-text-tertiary)]"}," Alle bestehenden Daten werden geloescht und durch ein vollstaendiges Demo-Sortiment ersetzt (Produkttypen, Attribute, Hierarchien, Produkte, Preise, Medien, Beziehungen). ",-1)),m.value?(a(),o("div",{key:0,class:S(["rounded-lg p-4 border",m.value.success?"bg-green-50 dark:bg-green-950/30 border-green-200 dark:border-green-800":"bg-red-50 dark:bg-red-950/30 border-red-200 dark:border-red-800"])},[e("div",{class:S(["flex items-center gap-2 text-sm font-medium",m.value.success?"text-green-700 dark:text-green-400":"text-red-700 dark:text-red-400"])},[m.value.success?(a(),y(s(H),{key:0,class:"w-4 h-4"})):(a(),y(s(A),{key:1,class:"w-4 h-4"})),g(" "+r(m.value.success?"Demo-Daten erfolgreich geladen":"Fehler beim Laden"),1)],2),m.value.message?(a(),o("p",Re,r(m.value.message),1)):d("",!0),m.value.import_result?(a(),o("details",ze,[t[7]||(t[7]=e("summary",{class:"cursor-pointer text-[var(--color-text-secondary)]"},"Import-Details anzeigen",-1)),e("pre",Ee,r(JSON.stringify(m.value.import_result,null,2)),1)])):d("",!0)],2)):d("",!0),T.value?(a(),o("div",Ae,[e("div",Me,[v(s(A),{class:"w-4 h-4"}),t[8]||(t[8]=g(" Fehler ",-1))]),e("p",Be,r(T.value),1)])):d("",!0),P.value?(a(),o("div",Ie,[v(s(V),{class:"w-5 h-5 animate-spin text-blue-500"}),t[9]||(t[9]=e("span",null,"Demo-Daten werden geladen... Reset, Excel-Generierung, Import...",-1))])):d("",!0),P.value?d("",!0):(a(),o("div",Pe,[R.value?d("",!0):(a(),o("button",{key:0,onClick:t[1]||(t[1]=l=>R.value=!0),class:"px-4 py-1.5 text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 transition-colors flex items-center gap-2"},[v(s(U),{class:"w-4 h-4"}),t[10]||(t[10]=g(" Demo-Daten laden ",-1))])),R.value?(a(),o(C,{key:1},[t[11]||(t[11]=e("span",{class:"text-xs text-[var(--color-text-secondary)]"},"Alle Daten werden geloescht und durch Demo-Daten ersetzt!",-1)),e("button",{onClick:K,class:"px-4 py-1.5 text-xs font-medium rounded-md text-white bg-red-600 hover:bg-red-700 transition-colors"},"Ja, laden"),e("button",{onClick:t[2]||(t[2]=l=>R.value=!1),class:"px-4 py-1.5 text-xs font-medium rounded-md text-[var(--color-text-secondary)] bg-[var(--color-bg-secondary)] hover:bg-[var(--color-bg-tertiary)] transition-colors"},"Abbrechen")],64)):d("",!0)]))])):d("",!0),s(F).userRole==="Admin"?(a(),o("div",Te,[e("div",qe,[v(s(ie),{class:"w-5 h-5 text-red-500","stroke-width":1.75}),e("h3",Ve,r(s(i)("settings.dangerZone")),1)]),e("div",null,[e("h4",Fe,r(s(i)("settings.resetTitle")),1),e("p",Ge,r(s(i)("settings.resetDescription")),1),_.value?(a(),o("div",{key:0,class:S(["mb-3 text-xs px-3 py-2 rounded",L.value?"bg-red-50 text-red-700 dark:bg-red-900/30 dark:text-red-400":"bg-green-50 text-green-700 dark:bg-green-900/30 dark:text-green-400"])},r(_.value),3)):d("",!0),I.value?(a(),o("div",Ne,[e("p",$e,r(s(i)("settings.resetConfirmPrompt")),1),te(e("input",{"onUpdate:modelValue":t[3]||(t[3]=l=>b.value=l),type:"text",class:"pim-input max-w-xs text-sm",placeholder:"RESET",disabled:f.value},null,8,je),[[se,b.value]]),e("div",He,[e("button",{class:"px-3 py-1.5 text-xs font-medium rounded-md text-white bg-red-600 hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",disabled:b.value!=="RESET"||f.value,onClick:Z},[f.value?(a(),o("span",Ue,r(s(i)("common.loading")),1)):(a(),o("span",Xe,r(s(i)("settings.resetExecute")),1))],8,Je),e("button",{class:"px-3 py-1.5 text-xs font-medium rounded-md text-[var(--color-text-secondary)] bg-[var(--color-bg-secondary)] hover:bg-[var(--color-bg-tertiary)] transition-colors",disabled:f.value,onClick:W},r(s(i)("common.cancel")),9,Oe)])])):(a(),o("button",{key:2,class:"px-3 py-1.5 text-xs font-medium rounded-md text-red-600 border border-red-300 hover:bg-red-50 dark:text-red-400 dark:border-red-700 dark:hover:bg-red-900/20 transition-colors",onClick:O},r(s(i)("settings.resetButton")),1))])])):d("",!0),s(G)?(a(),o("div",We,[e("div",Ze,[v(s(X),{class:"w-5 h-5 text-[var(--color-accent)]","stroke-width":1.75}),t[13]||(t[13]=e("h3",{class:"text-sm font-semibold"},"Server-Deployment",-1))]),p.value?(a(),o("div",Ke,[e("div",Qe,[v(s(ne),{class:"w-3.5 h-3.5","stroke-width":1.75}),e("span",Ye,r(p.value.branch),1),t[14]||(t[14]=e("span",{class:"text-[var(--color-text-tertiary)]"},"@",-1)),e("span",et,r(p.value.commit),1)]),e("p",tt,r(p.value.message),1),e("p",st,r(p.value.date)+" · Laravel "+r(p.value.laravel_version)+" · PHP "+r(p.value.php_version),1)])):d("",!0),e("div",at,[z.value?d("",!0):(a(),o("button",{key:0,onClick:t[4]||(t[4]=l=>z.value=!0),disabled:w.value,class:"pim-btn-primary flex items-center gap-2 text-sm"},[w.value?(a(),y(s(V),{key:0,class:"w-4 h-4 animate-spin"})):(a(),y(s(X),{key:1,class:"w-4 h-4","stroke-width":1.75})),t[15]||(t[15]=g(" Main Branch laden & deployen ",-1))],8,rt)),z.value&&!w.value?(a(),o(C,{key:1},[t[16]||(t[16]=e("span",{class:"text-xs text-[var(--color-text-secondary)]"},"Sicher? Der Server wird aktualisiert.",-1)),e("button",{onClick:Q,class:"pim-btn-danger text-sm px-4 py-1.5"},"Ja, deployen"),e("button",{onClick:t[5]||(t[5]=l=>z.value=!1),class:"pim-btn-secondary text-sm px-4 py-1.5"},"Abbrechen")],64)):d("",!0)]),w.value?(a(),o("div",ot,[v(s(V),{class:"w-5 h-5 animate-spin text-[var(--color-accent)]"}),t[17]||(t[17]=e("span",null,"Deployment läuft... Git Pull, Composer, Migrationen, Cache...",-1))])):d("",!0),D.value?(a(),o("div",lt,[e("div",nt,[v(s(A),{class:"w-4 h-4"}),t[18]||(t[18]=g(" Deployment-Fehler ",-1))]),e("p",dt,r(D.value),1)])):d("",!0),c.value?(a(),o("div",ct,[e("div",{class:S(["rounded-lg p-4 border",c.value.success?"bg-green-50 dark:bg-green-950/30 border-green-200 dark:border-green-800":"bg-yellow-50 dark:bg-yellow-950/30 border-yellow-200 dark:border-yellow-800"])},[e("div",{class:S(["flex items-center gap-2 text-sm font-medium",c.value.success?"text-green-700 dark:text-green-400":"text-yellow-700 dark:text-yellow-400"])},[c.value.success?(a(),y(s(H),{key:0,class:"w-4 h-4"})):(a(),y(s(A),{key:1,class:"w-4 h-4"})),g(" "+r(c.value.success?"Deployment erfolgreich":"Deployment mit Warnungen"),1)],2),e("p",{class:S(["text-xs mt-1",c.value.success?"text-green-600 dark:text-green-400":"text-yellow-600 dark:text-yellow-400"])}," Commit: "+r(c.value.commit)+" · Dauer: "+r(c.value.duration_seconds)+"s · Von: "+r(c.value.deployed_by),3)],2),e("details",it,[e("summary",ut," Deployment-Schritte anzeigen ("+r(((n=c.value.steps)==null?void 0:n.length)||0)+") ",1),e("div",xt,[(a(!0),o(C,null,j(c.value.steps,l=>(a(),o("div",{key:l.step,class:"flex items-start gap-2"},[l.success?(a(),y(s(H),{key:0,class:"w-3.5 h-3.5 text-green-500 mt-0.5 shrink-0"})):(a(),y(s(A),{key:1,class:"w-3.5 h-3.5 text-red-500 mt-0.5 shrink-0"})),e("div",null,[e("span",vt,r(l.step),1),l.output?(a(),o("span",mt,r(l.output.substring(0,200)),1)):d("",!0)])]))),128))])]),c.value.backup_hash?(a(),o("div",pt,[v(s(ce),{class:"w-4 h-4 text-[var(--color-text-tertiary)]","stroke-width":1.75}),e("span",yt,[t[19]||(t[19]=g(" Rollback auf ",-1)),e("span",gt,r((J=c.value.backup_hash)==null?void 0:J.substring(0,7)),1)]),e("button",{onClick:Y,disabled:q.value,class:"pim-btn-secondary text-xs px-3 py-1"},[q.value?(a(),y(s(V),{key:0,class:"w-3 h-3 animate-spin"})):(a(),o(C,{key:1},[g("Rollback")],64))],8,bt)])):d("",!0)])):d("",!0)])):d("",!0)])}}};export{_t as default};
