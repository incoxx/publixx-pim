import{n as L,r as c,c as M}from"./vendor-B0bC02TM.js";import{c as r,f as m}from"./index-B_89pp-1.js";const d={list(e={}){return r.get("/products",{params:m(e)})},get(e,t={}){return r.get(`/products/${e}`,{params:m(t)})},create(e){return r.post("/products",e)},update(e,t){return r.put(`/products/${e}`,t)},delete(e){return r.delete(`/products/${e}`)},getAttributeValues(e,t={}){return r.get(`/products/${e}/attribute-values`,{params:m(t)})},saveAttributeValues(e,t){return r.put(`/products/${e}/attribute-values`,{values:t})},getVariants(e){return r.get(`/products/${e}/variants`)},createVariant(e,t){return r.post(`/products/${e}/variants`,t)},getVariantRules(e){return r.get(`/products/${e}/variant-rules`)},setVariantRules(e,t){return r.put(`/products/${e}/variant-rules`,{rules:t})},getMedia(e){return r.get(`/products/${e}/media`)},attachMedia(e,t){return r.post(`/products/${e}/media`,t)},detachMedia(e){return r.delete(`/product-media/${e}`)},getPrices(e){return r.get(`/products/${e}/prices`)},createPrice(e,t){return r.post(`/products/${e}/prices`,t)},updatePrice(e,t){return r.put(`/product-prices/${e}`,t)},deletePrice(e){return r.delete(`/product-prices/${e}`)},getRelations(e){return r.get(`/products/${e}/relations`)},createRelation(e,t){return r.post(`/products/${e}/relations`,t)},deleteRelation(e){return r.delete(`/product-relations/${e}`)}},j=L("products",()=>{const e=c([]),t=c(null),i=c(!1),o=c(null),l=c({current_page:1,last_page:1,total:0,per_page:50}),f=c({}),p=c({field:"updated_at",order:"desc"}),g=c(""),$=M(()=>e.value.length===0&&!i.value);async function y(a={}){var u,s;i.value=!0,o.value=null;try{const{data:n}=await d.list({page:l.value.current_page,perPage:l.value.per_page,sort:p.value.field,order:p.value.order,search:g.value||void 0,filters:f.value,include:"productType",...a});e.value=n.data,n.meta&&(l.value=n.meta)}catch(n){o.value=((s=(u=n.response)==null?void 0:u.data)==null?void 0:s.title)||"Fehler beim Laden"}finally{i.value=!1}}async function h(a,u={}){var s,n;i.value=!0,o.value=null;try{const{data:v}=await d.get(a,{include:"attributeValues,variants,media,prices,productType",...u});t.value=v.data||v}catch(v){o.value=((n=(s=v.response)==null?void 0:s.data)==null?void 0:n.title)||"Fehler beim Laden"}finally{i.value=!1}}async function _(a){const{data:u}=await d.create(a);return u.data||u}async function b(a,u){var n;const{data:s}=await d.update(a,u);return((n=t.value)==null?void 0:n.id)===a&&Object.assign(t.value,s.data||s),s.data||s}async function V(a){var u;await d.delete(a),e.value=e.value.filter(s=>s.id!==a),((u=t.value)==null?void 0:u.id)===a&&(t.value=null)}async function P(a,u){await d.saveAttributeValues(a,u)}function w(a,u){p.value={field:a,order:u}}function A(a){g.value=a,l.value.current_page=1}function R(a){l.value.current_page=a}function S(a){f.value=a,l.value.current_page=1}function F(){e.value=[],t.value=null,i.value=!1,o.value=null,l.value={current_page:1,last_page:1,total:0,per_page:50}}return{items:e,current:t,loading:i,error:o,meta:l,filters:f,sort:p,search:g,isEmpty:$,fetchList:y,fetchOne:h,create:_,update:b,remove:V,saveAttributeValues:P,setSort:w,setSearch:A,setPage:R,setFilters:S,$reset:F}});export{j as u};
