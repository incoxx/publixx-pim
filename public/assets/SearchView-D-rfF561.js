import{r,t as w,v as x,j as k,x as c,L as S,M as N,U as B,B as V,y as A,q as f}from"./vendor-B0bC02TM.js";import{c as y,a as _}from"./index-B_89pp-1.js";import{_ as E}from"./PimTable-DtGX8hBe.js";import"./ellipsis-DAI6l6F-.js";const h={query(e,t={}){return y.post("/pql/query",{query:e,...t})},count(e){return y.post("/pql/query/count",{query:e})},validate(e){return y.post("/pql/query/validate",{query:e})},explain(e){return y.post("/pql/query/explain",{query:e})}};function K(){const e=r(""),t=r([]),l=r(0),i=r(!1),o=r(null),v=r(null),n=r(null);async function m(d,u={}){var s,a,q;i.value=!0,o.value=null;try{const{data:p}=await h.query(d||e.value,u);t.value=p.data||p,l.value=((s=p.meta)==null?void 0:s.total)||t.value.length}catch(p){o.value=((q=(a=p.response)==null?void 0:a.data)==null?void 0:q.detail)||"PQL-Fehler"}finally{i.value=!1}}async function b(d){var u,s;try{const{data:a}=await h.validate(d||e.value);return v.value=a,a.valid}catch(a){return v.value={valid:!1,errors:[(s=(u=a.response)==null?void 0:u.data)==null?void 0:s.detail]},!1}}async function g(d){var u,s;try{const{data:a}=await h.explain(d||e.value);n.value=a}catch(a){o.value=((s=(u=a.response)==null?void 0:u.data)==null?void 0:s.detail)||"Fehler"}}return{query:e,results:t,count:l,loading:i,error:o,validationResult:v,explainResult:n,execute:m,validate:b,explain:g}}const R={class:"space-y-4 max-w-3xl mx-auto"},U={class:"relative"},C={key:1,class:"text-center py-16"},$={__name:"SearchView",setup(e){const t=K(),l=r(""),i=[{key:"sku",label:"SKU",mono:!0},{key:"name_de",label:"Name"},{key:"status",label:"Status"}];async function o(){l.value.trim()&&await t.execute(`WHERE name CONTAINS "${l.value}" OR sku CONTAINS "${l.value}"`)}return(v,n)=>(f(),w("div",R,[x("div",U,[k(c(_),{class:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-[var(--color-text-tertiary)]","stroke-width":1.75}),S(x("input",{"onUpdate:modelValue":n[0]||(n[0]=m=>l.value=m),type:"text",placeholder:"Produkte, Attribute, SKUs durchsuchen...",class:"pim-input pl-12 pr-4 py-3 text-base",onKeydown:B(o,["enter"]),autofocus:""},null,544),[[N,l.value]])]),c(t).results.value.length>0?(f(),V(E,{key:0,columns:i,rows:c(t).results.value,loading:c(t).loading.value},null,8,["rows","loading"])):c(t).loading.value?A("",!0):(f(),w("div",C,[k(c(_),{class:"w-10 h-10 mx-auto mb-3 text-[var(--color-border-strong)]","stroke-width":1.5}),n[1]||(n[1]=x("p",{class:"text-sm text-[var(--color-text-tertiary)]"},"Suchbegriff eingeben und Enter druecken",-1))]))]))}};export{$ as default};
